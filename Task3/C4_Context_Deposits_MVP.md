# C4 Context Diagram: Онлайн открытие депозитов (MVP)

## Описание диаграммы контекста

Эта диаграмма показывает систему онлайн открытия депозитов в контексте пользователей и внешних систем.

---

## Люди (Actors)

### 1. **Клиент банка** (Person)
- **Описание:** Существующий клиент банка, авторизованный в интернет-банке
- **Взаимодействие:**
  - Просматривает депозиты с персонализированными ставками
  - Подаёт заявку на депозит
  - Получает СМС-уведомления
  - Отслеживает статус заявки

### 2. **Новый клиент** (Person)
- **Описание:** Потенциальный клиент, посещающий сайт банка
- **Взаимодействие:**
  - Просматривает депозиты на сайте
  - Подаёт заявку с ФИО и телефоном
  - Получает СМС-уведомления
  - Приходит в отделение для завершения

### 3. **Сотрудник кол-центра** (Person)
- **Описание:** Оператор кол-центра банка
- **Взаимодействие:**
  - Принимает заявки с сайта
  - Звонит клиентам
  - Предлагает особые условия
  - Передаёт заявки в обработку

### 4. **Сотрудник бэк-офиса депозитов** (Person)
- **Описание:** Специалист по обработке депозитных заявок
- **Взаимодействие:**
  - Обрабатывает заявки в АБС
  - Согласовывает ставки
  - Открывает депозиты
  - Управляет ставками

### 5. **Сотрудник бэк-офиса кредитов** (Person)
- **Описание:** Специалист по кредитному риску
- **Взаимодействие:**
  - Рассчитывает ставки депозитов ежедневно
  - Вводит ставки в систему управления ставками
  - Предоставляет данные по кредитному риску для VIP-клиентов

### 6. **Сотрудник отделения** (Person)
- **Описание:** Менеджер фронт-офиса в отделении банка
- **Взаимодействие:**
  - Идентифицирует новых клиентов
  - Завершает открытие депозита в АБС
  - Выдаёт документы

---

## Системы

### Основная система (в фокусе)

#### **Система онлайн открытия депозитов** [Software System] (ФОКУС)
- **Описание:** Новая система для подачи и обработки заявок на депозиты онлайн
- **Технологии:** Java Spring Boot, PostgreSQL, Kafka, Redis
- **Ответственность:**
  - Управление заявками на депозиты
  - Управление ставками депозитов
  - Интеграция между каналами и бэк-офисом
  - Буферизация нагрузки на АБС
- **Цвет на диаграмме:** Синий (система в фокусе)

---

### Существующие системы банка

#### **Интернет-банк** [Software System]
- **Описание:** Веб-приложение для клиентов банка
- **Технологии:** ASP.NET MVC 4.5, MS SQL
- **Ответственность:**
  - Авторизация клиентов
  - Отображение депозитов и ставок
  - Подача заявок на депозит
  - СМС-подтверждение операций
  - Отображение статусов заявок
- **Связь:** Интернет-банк → Система онлайн депозитов (HTTP API): "Подаёт заявки, получает ставки и статусы"
- **Цвет:** Серый (существующая система)

#### **Сайт банка** [Software System]
- **Описание:** Маркетинговый сайт и портал для потенциальных клиентов
- **Технологии:** PHP, React.js
- **Ответственность:**
  - Отображение информации о депозитах
  - Отображение актуальных ставок
  - Приём заявок от новых клиентов
- **Связь:** Сайт → Система онлайн депозитов (HTTP API): "Получает ставки, отправляет заявки"
- **Цвет:** Серый

#### **АБС (Автоматизированная банковская система)** [Software System]
- **Описание:** Основная банковская система учёта операций
- **Технологии:** Delphi, Oracle, PL-SQL
- **Ответственность:**
  - Учёт операций по счетам
  - Обработка заявок бэк-офисом
  - Открытие депозитов
  - Управление клиентами и продуктами
- **Связь:**
  - АБС ← Система онлайн депозитов (Kafka): "Получает заявки асинхронно"
  - АБС → Система онлайн депозитов (API): "Отправляет статусы заявок"
  - АБС → СМС-шлюз: "Отправляет СМС-уведомления"
- **Цвет:** Серый

#### **Система кол-центра** [Software System]
- **Описание:** CRM-платформа для операторов кол-центра
- **Технологии:** React.js, Java Spring Boot, PostgreSQL
- **Ответственность:**
  - Управление обращениями клиентов
  - Обработка заявок с сайта
  - Консультирование по депозитам
- **Связь:**
  - Система кол-центра ← Система онлайн депозитов (API/Webhook): "Получает заявки с сайта"
  - Система кол-центра → Система онлайн депозитов (API): "Обновляет статусы, передаёт заявки в АБС"
  - Система кол-центра → Система онлайн депозитов (API): "Получает актуальные ставки"
- **Цвет:** Серый

---

### Внешние системы

#### **СМС-шлюз** [Software System]
- **Описание:** Шлюз для отправки СМС через телеком-оператора
- **Технологии:** Внутренняя разработка
- **Ответственность:**
  - Отправка СМС клиентам
  - Генерация кодов подтверждения
- **Связь:** СМС-шлюз → Телеком-оператор (API): "Отправляет СМС"
- **Цвет:** Серый

#### **Телеком-оператор** [External System]
- **Описание:** Внешний оператор мобильной связи
- **Ответственность:** Доставка СМС клиентам
- **Цвет:** Светло-серый (внешняя система)

---

## Связи между элементами

### Клиенты и системы:

1. **Клиент банка → Интернет-банк** [HTTPS]
   - "Авторизуется, просматривает депозиты, подаёт заявки"

2. **Новый клиент → Сайт банка** [HTTPS]
   - "Просматривает депозиты, подаёт заявки"

3. **Клиент / Новый клиент ← Телеком-оператор** [SMS]
   - "Получает СМС-уведомления и коды подтверждения"

4. **Сотрудник кол-центра → Система кол-центра** [HTTPS]
   - "Обрабатывает заявки, консультирует клиентов"

5. **Сотрудник бэк-офиса депозитов → АБС** [Desktop App]
   - "Обрабатывает заявки, открывает депозиты"

6. **Сотрудник бэк-офиса кредитов → Система онлайн депозитов** [HTTPS]
   - "Управляет ставками депозитов"

7. **Сотрудник отделения → АБС** [Desktop App]
   - "Открывает депозиты для новых клиентов после идентификации"

### Системы между собой:

8. **Интернет-банк → Система онлайн депозитов** [HTTPS/JSON API]
   - "Получает ставки, подаёт заявки, получает статусы"

9. **Сайт → Система онлайн депозитов** [HTTPS/JSON API]
   - "Получает ставки, подаёт заявки"

10. **Система кол-центра ↔ Система онлайн депозитов** [HTTPS/JSON API + Webhook]
    - "Получает заявки с сайта, получает ставки, обновляет статусы"

11. **Система онлайн депозитов → АБС** [Kafka]
    - "Отправляет заявки асинхронно"

12. **АБС → Система онлайн депозитов** [HTTP API]
    - "Отправляет обновления статусов заявок"

13. **АБС → СМС-шлюз** [API]
    - "Отправляет команды на СМС-уведомления"

14. **СМС-шлюз → Телеком-оператор** [API]
    - "Отправляет СМС"

---

## Ключевые потоки данных

### Поток 1: Подача заявки с сайта
```
Новый клиент → Сайт → Система онлайн депозитов → Система кол-центра
→ Сотрудник кол-центра → Система онлайн депозитов → Kafka → АБС
→ Сотрудник бэк-офиса депозитов → АБС → СМС-шлюз → Телеком-оператор → Клиент
```

### Поток 2: Подача заявки из интернет-банка
```
Клиент банка → Интернет-банк → Система онлайн депозитов → Kafka → АБС
→ Сотрудник бэк-офиса депозитов → АБС → СМС-шлюз → Телеком-оператор → Клиент
```

### Поток 3: Управление ставками
```
Сотрудник бэк-офиса кредитов → Система онлайн депозитов (Rate Management)
→ публикация ставок → [Сайт, Интернет-банк, Система кол-центра, АБС]
```

---

## Примечания для визуализации

**Цветовая схема:**
- **Синий** - Система в фокусе (Система онлайн открытия депозитов)
- **Серый** - Существующие системы банка
- **Светло-серый** - Внешние системы
- **Зелёный** - Люди (акторы)

**Группировка:**
- Сгруппировать системы банка в контейнер "Банк 'Стандарт'"
- Выделить границу между внутренними и внешними системами

**Стиль C4:**
- Использовать нотацию C4 Model (прямоугольники с заголовками)
- Указать типы: [Person], [Software System], [External System]
- На стрелках указать технологию и краткое описание взаимодействия

---

## Инструкция для создания диаграммы в draw.io:

1. Создать новый файл `C4_Context_Deposits_MVP.drawio`
2. Использовать библиотеку C4 Model (можно импортировать)
3. Разместить "Систему онлайн открытия депозитов" в центре (синий цвет)
4. Вокруг разместить акторов (вверху)
5. Ниже - существующие системы банка
6. Справа внизу - внешние системы
7. Соединить стрелками согласно списку связей выше
8. Добавить легенду с цветовым кодированием
